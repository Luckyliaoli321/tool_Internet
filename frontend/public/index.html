<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta
      name="description"
      content="åœ¨çº¿æ–‡ä»¶å·¥å…·é›†ï¼Œæ”¯æŒæ ¼å¼è½¬æ¢ã€å›¾ç‰‡å¤„ç†ç­‰åŠŸèƒ½"
    />
    <link rel="apple-touch-icon" href="%PUBLIC_URL%/logo192.png" />
    
    <!-- æœ€æ—©æœŸæ‹¦æˆªlocalhostè¯·æ±‚çš„è„šæœ¬ -->
    <script>
      (function(){
        // åœ¨é¡µé¢åŠ è½½æœ€æ—©æœŸå°±åŠ«æŒæ‰€æœ‰ç½‘ç»œè¯·æ±‚æ–¹æ³•
        console.log('ğŸ”’ æœ€æ—©æœŸè¯·æ±‚æ‹¦æˆªå™¨å·²æ¿€æ´»');
        
        // å®šä¹‰ä¸€ä¸ªå¤„ç†å‡½æ•°æ¥å¤„ç†æ‰€æœ‰ç½‘ç»œè¯·æ±‚
        function blockLocalhostRequests(url) {
          if (typeof url === 'string' && (url.includes('localhost') || url.includes('127.0.0.1'))) {
            console.error('â›” æ ¸å¿ƒæ‹¦æˆª: ' + url);
            throw new Error('ç¦æ­¢localhostè¯·æ±‚');
          }
          return url;
        }
        
        // 1. æ‹¦æˆªXHR
        if (window.XMLHttpRequest) {
          var originalXHROpen = XMLHttpRequest.prototype.open;
          XMLHttpRequest.prototype.open = function(method, url) {
            try {
              url = blockLocalhostRequests(url);
            } catch (e) {
              // å¯¹äºXHRï¼Œæˆ‘ä»¬å°†URLé‡å®šå‘åˆ°ä¸€ä¸ªæ— æ•ˆåœ°å€
              url = 'https://invalid-blocked-request/';
              var self = this;
              setTimeout(function() {
                if (self.onerror) self.onerror(new Error('è¯·æ±‚å·²è¢«é˜»æ­¢'));
              }, 0);
            }
            return originalXHROpen.apply(this, [method, url].concat(Array.prototype.slice.call(arguments, 2)));
          };
        }
        
        // 2. æ‹¦æˆªfetch
        if (window.fetch) {
          var originalFetch = window.fetch;
          window.fetch = function(input) {
            try {
              if (typeof input === 'string') {
                blockLocalhostRequests(input);
              } else if (input instanceof Request) {
                blockLocalhostRequests(input.url);
              }
            } catch (e) {
              return Promise.reject(e);
            }
            return originalFetch.apply(this, arguments);
          };
        }
        
        // 3. æ·»åŠ å…¨å±€é”™è¯¯å¤„ç†ï¼Œéšè—ç‰¹å®šé”™è¯¯
        window.addEventListener('error', function(e) {
          // éšè—ç‰¹å®šçš„é”™è¯¯ä¿¡æ¯
          if (e.message && (
              e.message.includes('localhost') || 
              e.message.indexOf('Failed to load resource') !== -1 || 
              e.message.indexOf('net::ERR_CONNECTION_REFUSED') !== -1)
          ) {
            console.warn('ğŸ™ˆ éšè—é”™è¯¯:', e.message);
            e.preventDefault();
            return false;
          }
        }, true);
        
        // æœ€é‡è¦ï¼šä¸“é—¨å¤„ç†å·²çŸ¥æ ¼å¼è¯·æ±‚é”™è¯¯
        window.__fileFormatsFallback = {
          success: true,
          formats: [
            {
              name: 'Wordæ–‡æ¡£',
              extension: 'docx',
              targetFormats: [
                { name: 'PDFæ–‡æ¡£', extension: 'pdf' },
                { name: 'æ–‡æœ¬æ–‡ä»¶', extension: 'txt' }
              ]
            },
            {
              name: 'PDFæ–‡æ¡£',
              extension: 'pdf',
              targetFormats: [
                { name: 'Wordæ–‡æ¡£', extension: 'docx' },
                { name: 'æ–‡æœ¬æ–‡ä»¶', extension: 'txt' }
              ]
            },
            {
              name: 'Excelè¡¨æ ¼',
              extension: 'xlsx',
              targetFormats: [
                { name: 'CSVæ–‡ä»¶', extension: 'csv' },
                { name: 'PDFæ–‡æ¡£', extension: 'pdf' }
              ]
            },
            {
              name: 'å›¾ç‰‡',
              extension: 'jpg',
              targetFormats: [
                { name: 'PNGå›¾ç‰‡', extension: 'png' },
                { name: 'WebPå›¾ç‰‡', extension: 'webp' }
              ]
            }
          ]
        };
      })();
    </script>
    
    <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
    <title>æ–‡ä»¶å·¥å…·ç®±</title>
    <!-- å¯¼å…¥æ€æºé»‘ä½“ -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
  </head>
  <body>
    <noscript>æ‚¨éœ€è¦å¯ç”¨JavaScriptæ‰èƒ½è¿è¡Œæ­¤åº”ç”¨</noscript>
    <div id="root"></div>
  </body>
</html> 